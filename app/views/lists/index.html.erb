<% content_for :title, "リスト一覧" %>

<div class="container py-4 pb-24">
  <p class="text-sm font-medium text-gray-600 mb-2">フィルタ</p>
  <div class="bg-white rounded-lg shadow-sm p-4 mb-6">
    <%= form_with url: lists_path, method: :get, local: true do |f| %>
      <div class="flex gap-3 items-center flex-wrap">
        <div class="flex-1 min-w-[160px]">
          <%= f.label :status, "ステータス",
            class: "block text-sm font-medium text-gray-700 mb-1" %>

          <%= f.select :status,
            options_for_select([
              ["全て", ""], ["待機中", "waiting"], ["チェック中", "checking"], ["完了", "completed"]
            ], params[:status]), {},
            class: "w-full border border-gray-300 rounded-md px-3 py-2" %>
        </div>

        <div class="flex-1 min-w-[160px]">
          <%= f.label :category_id, "カテゴリー",
            class: "block text-sm font-medium text-gray-700 mb-1" %>

          <%= f.select :category_id,
            options_from_collection_for_select(
              @categories, :id, :name, params[:category_id]),
            { include_blank: "すべて" },
            class: "w-full border border-gray-300 rounded-md px-3 py-2" %>
        </div>

        <div class="flex gap-2 self-end">
          <%= f.submit "絞り込む", class: "h-[42px] px-4 bg-blue-600 text-white rounded-md" %>
          <%= link_to "クリア", lists_path,
            class: "h-[42px] px-4 border border-gray-300 rounded-md flex items-center" %>
        </div>
      </div>
    <% end %>
  </div>
  <% if params[:status].present? %>
    <div class="flex items-center gap-2 mb-4">
      <span class="text-sm text-gray-600">
        ステータス「<%= t("enums.list.status.#{params[:status]}") %>」で絞り込み中
      </span>
      <%= link_to "✕", lists_path,
        class: "text-gray-400 hover:text-gray-600" %>
    </div>
  <% end %>
  <% if params[:category_id].present? && @current_category %>
    <div class="flex items-center gap-2 mb-4">
      <span class="text-sm text-gray-600">
        カテゴリー「<%= @current_category.name %>」で絞り込み中
      </span>
      <%= link_to "✕", lists_path,
        class: "text-gray-400 hover:text-gray-600" %>
    </div>
  <% end %>
  <section class="mb-6">
    <h2 class="text-xl font-bold mb-4">チェック中</h2>
    <% if @checking_lists.any? %>
      <div class="space-y-4">
        <%= render @checking_lists %>
      </div>
    <% else %>
      <%= render "shared/empty_state", message: "チェック中のリストはありません" %>
    <% end %>
  </section>

  <section class="mb-6">
    <h2 class="text-xl font-bold mb-4">今日のリスト</h2>
    <% if @today_lists.any? %>
      <div class="space-y-4">
        <%= render @today_lists %>
      </div>
    <% else %>
      <%= render "shared/empty_state", message: "今日のリストはありません" %>
    <% end %>
  </section>

  <section class="mb-6">
    <h2 class="text-xl font-bold mb-4">全てのリスト</h2>
    <% if @all_lists.any? %>
      <div class="space-y-4">
        <%= render @all_lists %>
      </div>
    <% else %>
      <%= render "shared/empty_state", message: "リストはありません" %>
    <% end %>
  </section>
</div>

<%= render "shared/fab" %>
