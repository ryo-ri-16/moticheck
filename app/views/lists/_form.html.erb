<div class="bg-white rounded-lg shadow-sm p-4 space-y-4">
  <%= form_with model: @list do |f| %>
    <%= render "shared/error_messages", object: f.object %>

    <div class="space-y-2">
      <%= f.label :title, class: "block text-sm font-medium text-gray-700" do %>
        ã‚¿ã‚¤ãƒˆãƒ« <span class="text-red-700">*</span>
      <% end %>
      <%= f.text_field :title,
        class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",
        placeholder: "ä¾‹: æ—…è¡Œã®æŒã¡ç‰©" %>
    </div>

    <div class="space-y-2">
      <%= f.label :scheduled_on, class: "block text-sm font-medium text-gray-700" do %>
        åˆ©ç”¨æ—¥ <span class="text-red-700">*</span>
      <% end %>
      <%= f.date_field :scheduled_on,
        class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" %>
    </div>

    <div class="space-y-2">
      <%= f.label :scheduled_time, class: "block text-sm font-medium text-gray-700" do %>
        åˆ©ç”¨æ™‚åˆ»
        <span class="text-xs text-gray-500 font-normal">(ä»»æ„)</span>
      <% end %>
      <%= f.time_field :scheduled_time,
        class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" %>
    </div>

    <div class="mb-4">
      <%= f.label :category_id, "ã‚«ãƒ†ã‚´ãƒªãƒ¼", class: "block text-sm font-medium text-gray-700 mb-2" %>
      <%= f.select :category_id,
      options_from_collection_for_select(
        @categories, :id, :name, list.category_id
      ),
      { include_blank: 'æœªåˆ†é¡' },
      class: "w-full px-3 py-2 border border-gray-300 rounded-md" %>

      <div class="mt-2">
        <label class="flex items-center text-sm text-gray-600">
          <input type="checkbox" id="new_category_toggle" class="mr-2">
          æ–°ã—ã„ã‚«ãƒ†ã‚´ãƒªãƒ¼ã‚’ä½œæˆ
        </label>

        <div id="new_category_field" class="mt-2 hidden">
          <%= text_field_tag :new_category_name, nil,
            placeholder: "æ–°ã—ã„ã‚«ãƒ†ã‚´ãƒªãƒ¼å",
            class: "w-full px-3 py-2 border border-gray-300 rounded-md" %>
        </div>
      </div>
    </div>

    <div class="space-y-2 mt-4">
      <div class="flex items-center gap-2">
        <%= f.check_box :priority,
          class: "h-5 w-5 text-blue-600 border-gray-300 rounded focus:ring-2 focus:ring-blue-500" %>
        <%= f.label :priority, "å„ªå…ˆãƒªã‚¹ãƒˆã«ã™ã‚‹", class: "text-sm font-medium text-gray-700 cursor-pointer" %>
      </div>
      <p class="text-xs text-gray-500 pl-7">
        ğŸ’¡ ä¸€è¦§ã§ä¸Šã«è¡¨ç¤ºã•ã‚Œã¾ã™
      </p>
    </div>

    <div class="space-y-2 mt-4">
      <%= f.label :note, class: "block text-sm font-medium text-gray-700" do %>
        ãƒ¡ãƒ¢
        <span class="text-xs text-gray-500 font-normal">(ä»»æ„)</span>
      <% end %>
      <%= f.text_area :note,
        class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",
        rows: 2,
        placeholder: "æŒã¡ç‰©ã®è£œè¶³æƒ…å ±ã‚„ãƒ¡ãƒ¢ã‚’è¨˜å…¥ã§ãã¾ã™" %>
    </div>

    <div class="pt-2 mt-4">
      <%= f.submit list.new_record? ? "ä½œæˆã™ã‚‹" : "å¤‰æ›´ã‚’ä¿å­˜ã™ã‚‹",
        class: "w-full px-4 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-md font-semibold transition-colors shadow-sm" %>
    </div>
  <% end %>
</div>

<div class="mt-3 p-3 bg-blue-50 border border-blue-200 rounded-md">
  <p class="text-sm text-blue-800">
    ğŸ’¡ ãƒªã‚¹ãƒˆä½œæˆå¾Œã€ãƒã‚§ãƒƒã‚¯é …ç›®ã‚’è¿½åŠ ã§ãã¾ã™
  </p>
</div>

<script>
  document.getElementById('new_category_toggle')?.addEventListener('change', function(e) {
    const field = document.getElementById('new_category_field');
    const select = document.querySelector('select[name="list[category_id]"]');

    if (e.target.checked) {
      field.classList.remove('hidden');
      select.disabled = true;
    } else {
      field.classList.add('hidden');
      select.disabled = false;
    }
  });
</script>
